<!DOCTYPE html>
<html>
<head>
    <title>Checkout</title>
</head>
<body>
    <h1>Checkout</h1>
    <h2>Product Details</h2>
    <p>Name: {{ product.product_name }}</p>
    <p>Description: {{ product.product_description }}</p>
    <p>Price: {{ product.product_price }}</p>

    <!-- Loading spinner while PayPal button is loading -->
    <div id="loading-spinner" style="display: none;">
        <div class="loading-spinner"></div>
    </div>

    <!-- Include the PayPal JavaScript SDK asynchronously -->
    <div id="paypal-button-container"></div>

    <!-- Success message -->
    <div id="success-message" style="display: none;">
        Payment successful. Your order has been created!
    </div>

    <!-- Failure message -->
    <div id="failure-message" style="display: none;">
        Payment failed. Please try again later.
    </div>

    

                    <!-- Include the PayPal JavaScript SDK -->
                    <script src="https://www.paypal.com/sdk/js?client-id=AQ7EgIrAzcpmnhG2wvViA9o6uFn4hhsY5QihpAKwKQVfoyEUoe-HXjZ02vmJh6CzKtp25JE65d-kkqKX&currency=USD"></script>

                    <script>
                        // Render the PayPal button into #paypal-button-container
                        paypal.Buttons({
                            // Set up the transaction
                            createOrder: function (data, actions) {
                                return actions.order.create({
                                    purchase_units: [{
                                        amount: {
                                            value: '{{product.product_price}}'
                                        }
                                    }]
                                });
                            },

                            // Finalize the transaction
                            onApprove: function (data, actions) {
                                return actions.order.capture().then(function (details) {
                                    // Show a success message to the buyer
                                    alert('Transaction completed by ' + details.payer.name.given_name + '!');

                                    // Redirect to the order_success page after successful payment
                                    window.location.href = '{% url "payment:order_success" product_id %}';
                                });
                            }
                        }).render('#paypal-button-container');
                    </script>
</body>
</html>
